<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Vietnam Trip Dec 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Chosen Palette: Warm Neutrals & Tropical Accents -->
    <!-- Primary Background: #FAF9F6 (Off White) -->
    <!-- Text: #1F2937 (Gray 800) -->
    <!-- Accent HCMC: #7E22CE (Purple 700 - Royal) -->
    <!-- Accent Da Nang: #0891B2 (Cyan 600 - Ocean) -->
    
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #FAF9F6;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        /* Hide scrollbar for horizontal scrolling elements */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .btn-map {
            transition: all 0.2s;
        }
        .btn-map:active {
            transform: scale(0.95);
        }
        .filter-btn {
            transition: all 0.2s;
        }
        /* Pulse animation for the live indicator */
        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 0.5; }
            100% { transform: scale(2); opacity: 0; }
        }
        .live-dot {
            position: relative;
        }
        .live-dot::before {
            content: '';
            position: absolute;
            left: 0; top: 0;
            width: 100%; height: 100%;
            background-color: inherit;
            border-radius: 50%;
            z-index: -1;
            animation: pulse-ring 2s infinite;
        }
    </style>
</head>
<body class="text-gray-800 antialiased pb-20">

    <!-- Navigation / Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <div class="bg-purple-600 text-white p-2 rounded-lg">
                    <i class="fas fa-plane-departure"></i>
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight">Vietnam 2025</h1>
                    <p class="text-xs text-gray-500">10 Adults ‚Ä¢ 2 Kids</p>
                </div>
            </div>
            <div class="text-right">
                <div class="text-xs font-semibold text-cyan-600 bg-cyan-50 px-2 py-1 rounded-full">
                    Dec 20 - 28
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-4xl mx-auto px-4 py-6 space-y-8">

        <!-- Intro Section -->
        <section class="text-center space-y-2">
            <h2 class="text-2xl font-bold text-gray-800">Welcome to Vietnam</h2>
            <p class="text-gray-600 text-sm max-w-lg mx-auto">
                Your updated itinerary with addresses, maps, and flight details.
            </p>
        </section>

        <!-- Quick Actions / Logistics Hub -->
        <section id="logistics" class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- HCMC Logistics -->
            <div class="bg-white p-5 rounded-xl shadow-sm border-l-4 border-purple-500">
                <div class="flex justify-between items-start mb-3">
                    <h3 class="font-bold text-lg text-purple-700">üìç Ho Chi Minh City</h3>
                    <span class="text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded">Dec 20-23</span>
                </div>
                <div class="space-y-4">
                    <!-- Accommodation -->
                    <div class="bg-gray-50 p-3 rounded-lg relative group">
                        <p class="text-xs text-gray-500 uppercase font-semibold">Accommodation</p>
                        <p class="font-medium text-sm mt-1">38 Dinh Tien Hoang, Da Kao, District 1</p>
                        <div class="flex space-x-2 mt-2">
                            <button onclick="copyText('38 Dinh Tien Hoang, Ho Chi Minh')" class="text-xs bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded text-gray-600"><i class="far fa-copy mr-1"></i> Copy</button>
                            <a href="https://www.google.com/maps/search/?api=1&query=38+Dinh+Tien+Hoang+District+1+Ho+Chi+Minh" target="_blank" class="text-xs bg-purple-100 hover:bg-purple-200 text-purple-800 px-2 py-1 rounded"><i class="fas fa-map-marker-alt mr-1"></i> Map</a>
                        </div>
                    </div>
                    
                    <!-- Arrival Flight Card -->
                    <div class="bg-purple-50 p-3 rounded-lg border border-purple-100">
                         <div class="flex justify-between items-start">
                            <p class="text-xs text-purple-800 uppercase font-bold"><i class="fas fa-plane-arrival mr-1"></i> ARRIVAL: SQ 184</p>
                            <span class="text-xs text-purple-700 bg-white px-1.5 rounded border border-purple-100">Dec 20</span>
                         </div>
                         <div class="flex justify-between items-center mt-2 text-sm">
                            <div class="text-center">
                                <span class="block font-bold text-gray-800 text-base">1:50 PM</span>
                                <span class="text-xs text-gray-500 bg-white px-1 rounded">SIN (T2)</span>
                            </div>
                            <div class="text-purple-400 text-xs flex flex-col items-center">
                                <span class="text-[10px] text-purple-700 font-semibold mb-0.5">Singapore Air</span>
                                <i class="fas fa-long-arrow-alt-right text-lg"></i>
                            </div>
                            <div class="text-center">
                                <span class="block font-bold text-gray-800 text-base">3:00 PM</span>
                                <span class="text-xs text-gray-500 bg-white px-1 rounded">SGN (T2)</span>
                            </div>
                         </div>
                    </div>

                    <!-- Domestic Flight Card -->
                     <div class="bg-purple-50 p-3 rounded-lg border border-purple-100">
                        <div class="flex justify-between items-start">
                           <p class="text-xs text-purple-800 uppercase font-bold"><i class="fas fa-plane mr-1"></i> DOMESTIC: VN 132</p>
                           <span class="text-xs text-purple-700 bg-white px-1.5 rounded border border-purple-100">Dec 23</span>
                        </div>
                        <div class="flex justify-between items-center mt-2 text-sm">
                           <div class="text-center">
                               <span class="block font-bold text-gray-800 text-base">1:25 PM</span>
                               <span class="text-xs text-gray-500 bg-white px-1 rounded">SGN (T1)</span>
                           </div>
                           <div class="text-purple-400 text-xs flex flex-col items-center">
                               <span class="text-[10px] text-purple-700 font-semibold mb-0.5">Vietnam Air</span>
                               <i class="fas fa-long-arrow-alt-right text-lg"></i>
                           </div>
                           <div class="text-center">
                               <span class="block font-bold text-gray-800 text-base">2:50 PM</span>
                               <span class="text-xs text-gray-500 bg-white px-1 rounded">DAD (T1)</span>
                           </div>
                        </div>
                   </div>

                </div>
            </div>

            <!-- Da Nang Logistics -->
            <div class="bg-white p-5 rounded-xl shadow-sm border-l-4 border-cyan-500">
                <div class="flex justify-between items-start mb-3">
                    <h3 class="font-bold text-lg text-cyan-700">üåä Da Nang</h3>
                    <span class="text-xs bg-cyan-100 text-cyan-800 px-2 py-1 rounded">Dec 23-28</span>
                </div>
                <div class="space-y-4">
                    <!-- Accommodation -->
                    <div class="bg-gray-50 p-3 rounded-lg relative group">
                        <p class="text-xs text-gray-500 uppercase font-semibold">Accommodation</p>
                        <p class="font-medium text-sm mt-1">5 Phan Ba Vanh, Son Tra, Da Nang</p>
                        <div class="flex space-x-2 mt-2">
                            <button onclick="copyText('5 Phan Ba Vanh, Son Tra, Da Nang')" class="text-xs bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded text-gray-600"><i class="far fa-copy mr-1"></i> Copy</button>
                            <a href="https://www.google.com/maps/search/?api=1&query=5+Phan+Ba+Vanh+Son+Tra+Da+Nang" target="_blank" class="text-xs bg-cyan-100 hover:bg-cyan-200 text-cyan-800 px-2 py-1 rounded"><i class="fas fa-map-marker-alt mr-1"></i> Map</a>
                        </div>
                    </div>

                    <!-- Return Flight Card -->
                    <div class="bg-cyan-50 p-3 rounded-lg border border-cyan-100">
                        <div class="flex justify-between items-start">
                           <p class="text-xs text-cyan-800 uppercase font-bold"><i class="fas fa-plane-departure mr-1"></i> DEPARTURE: SQ 171</p>
                           <span class="text-xs text-cyan-600 bg-white px-1.5 rounded border border-cyan-100">Dec 28</span>
                        </div>
                        <div class="flex justify-between items-center mt-2 text-sm">
                           <div class="text-center">
                               <span class="block font-bold text-gray-800 text-base">11:50 AM</span>
                               <span class="text-xs text-gray-500 bg-white px-1 rounded">DAD (T2)</span>
                           </div>
                           <div class="text-cyan-300 text-xs flex flex-col items-center">
                               <span class="text-[10px] text-cyan-600 font-semibold mb-0.5">Singapore Air</span>
                               <i class="fas fa-long-arrow-alt-right text-lg"></i>
                           </div>
                           <div class="text-center">
                               <span class="block font-bold text-gray-800 text-base">3:50 PM</span>
                               <span class="text-xs text-gray-500 bg-white px-1 rounded">SIN (T2)</span>
                           </div>
                        </div>
                   </div>

                </div>
            </div>
            
            <!-- Dynamic "Up Next" Block -->
            <div id="upNextBlock" class="bg-gradient-to-r from-gray-900 to-gray-800 p-5 rounded-xl border border-gray-700 md:col-span-2 text-white shadow-lg relative overflow-hidden">
                <div class="flex items-center space-x-2 mb-2">
                    <span class="live-dot w-2 h-2 bg-green-500 rounded-full inline-block"></span>
                    <p class="text-xs font-bold uppercase tracking-widest text-gray-400">Up Next On Your Schedule</p>
                </div>
                
                <div id="upNextContent">
                    <!-- Javascript will populate this -->
                    <div class="animate-pulse flex space-x-4">
                        <div class="flex-1 space-y-2 py-1">
                            <div class="h-4 bg-gray-700 rounded w-3/4"></div>
                            <div class="h-4 bg-gray-700 rounded w-1/2"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Itinerary Section -->
        <section id="itinerary" class="space-y-4">
            <div class="flex items-center justify-between">
                <h3 class="text-xl font-bold text-gray-800">Daily Itinerary</h3>
                <span class="text-xs text-gray-500">Tap days to view details</span>
            </div>

            <!-- Date Tabs -->
            <div class="flex space-x-2 overflow-x-auto no-scrollbar pb-2" id="dayTabs">
                <!-- Injected via JS -->
            </div>

            <!-- Timeline Container -->
            <div id="timelineContent" class="bg-white rounded-xl shadow-sm p-5 min-h-[300px]">
                <!-- Content injected via JS -->
            </div>
        </section>

        <!-- Recommendations Explorer -->
        <section id="explorer" class="space-y-4">
            <div>
                <h3 class="text-xl font-bold text-gray-800">Activity & Food Explorer</h3>
                <p class="text-sm text-gray-500">Filter by city and category to find the perfect spot.</p>
            </div>

            <div class="flex flex-col gap-3 bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                <!-- City Filter Row -->
                <div class="flex items-center space-x-2 overflow-x-auto no-scrollbar">
                    <span class="text-xs font-bold text-gray-400 uppercase tracking-wider mr-2">Region:</span>
                    <button onclick="setCityFilter('all')" class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium border transition city-filter bg-gray-800 text-white border-gray-800" data-val="all">All Locations</button>
                    <button onclick="setCityFilter('hcmc')" class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium border transition city-filter bg-white text-gray-600 border-gray-200 hover:bg-purple-50 hover:border-purple-200 hover:text-purple-700" data-val="hcmc">HCMC</button>
                    <button onclick="setCityFilter('danang')" class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium border transition city-filter bg-white text-gray-600 border-gray-200 hover:bg-cyan-50 hover:border-cyan-200 hover:text-cyan-700" data-val="danang">Da Nang</button>
                </div>

                <!-- Type Filter Row -->
                <div class="flex items-center space-x-2 overflow-x-auto no-scrollbar">
                    <span class="text-xs font-bold text-gray-400 uppercase tracking-wider mr-2">Category:</span>
                    <button onclick="setTypeFilter('all')" class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium border transition type-filter bg-gray-200 text-gray-800 border-gray-300" data-val="all">All</button>
                    <button onclick="setTypeFilter('food')" class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium border transition type-filter bg-white text-gray-600 border-gray-200 hover:bg-orange-50 hover:text-orange-700" data-val="food">Food</button>
                    <button onclick="setTypeFilter('activity')" class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium border transition type-filter bg-white text-gray-600 border-gray-200 hover:bg-blue-50 hover:text-blue-700" data-val="activity">Activities</button>
                    <button onclick="setTypeFilter('shopping')" class="filter-btn px-3 py-1.5 rounded-full text-xs font-medium border transition type-filter bg-white text-gray-600 border-gray-200 hover:bg-pink-50 hover:text-pink-700" data-val="shopping">Shopping</button>
                </div>
            </div>

            <div id="recommendationsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Populated by JS -->
            </div>
        </section>

    </main>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-5 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-full text-sm shadow-lg opacity-0 transition-opacity duration-300 pointer-events-none z-50">
        Copied to clipboard!
    </div>

    <!-- JavaScript Application Logic -->
    <script>
        // --- DATA STORE ---

        const itineraryData = [
            {
                date: "Dec 20",
                day: "Sat",
                city: "HCMC",
                color: "purple",
                events: [
                    { time: "1:50 PM", title: "Depart Singapore (SQ 184)", desc: "Changi Airport Terminal 2." },
                    { time: "3:00 PM", title: "Land at SGN Airport", desc: "Arrival at SGN Terminal 2. Clear immigration. Book two 7-seater Grabs." },
                    { time: "5:30 PM", title: "Check-in Airbnb", desc: "38 Dinh Tien Hoang. Freshen up." },
                    { 
                        time: "7:00 PM", 
                        title: "Man Moi (Tao Dan)", 
                        isBooked: true, 
                        address: "34 Vo Van Tan, Phuong 6, Quan 3",
                        mapLink: "https://www.google.com/maps?q=M·∫∑n+M√≤i,+Tao+ƒê√†n+-+34+V√µ+VƒÉn+T·∫ßn,+34+V√µ+VƒÉn+T·∫ßn,+Ph∆∞·ªùng+6,+Qu·∫≠n+3,+Th√†nh+ph·ªë+H·ªì+Ch√≠+Minh+70000,+Vietnam&ftid=0x31752f45e3ba9d6d:0x2b118e6c5816cfc0&entry=gps",
                        desc: "Modern Vietnamese bistro. Estimate ~20 min Grab." 
                    },
                    { 
                        time: "9:00 PM", 
                        title: "Nguyen Hue Walking Street", 
                        address: "Nguyen Hue, District 1, HCMC",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Nguyen+Hue+Walking+Street",
                        desc: "Travel: ~15 mins from Man Moi. Open 24/7 (best vibes until 11 PM). Highlights: Street performers, City Hall, and the 'Cafe Apartment' block (No. 42). Not a street food hub, but great for walking. Return: ~10 min Grab to Airbnb." 
                    }
                ]
            },
            {
                date: "Dec 21",
                day: "Sun",
                city: "HCMC",
                color: "purple",
                events: [
                    { 
                        time: "8:00 AM", 
                        title: "Cu Chi Tunnels Tour", 
                        address: "Phu Hiep, Cu Chi, HCMC",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Cu+Chi+Tunnels",
                        desc: "Half-day private tour. Wear bug spray." 
                    },
                    { 
                        time: "1:00 PM", 
                        title: "Lunch: Secret Garden", 
                        address: "158 Pasteur, Ben Nghe, District 1",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Secret+Garden+Restaurant+158+Pasteur",
                        desc: "Rooftop home-cooked style Vietnamese food. Walk up stairs." 
                    },
                    { 
                        time: "3:00 PM", 
                        title: "Artinus 3D Art Museum", 
                        address: "02-04 Road 9, Him Lam, District 7",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Artinus+3D+Art+Museum",
                        desc: "Great for 9 & 11 year olds. Funny photos. Indoor and AC cooled." 
                    },
                    { 
                        time: "7:00 PM", 
                        title: "Ben Thanh Night Market", 
                        address: "Le Loi, Ben Thanh, District 1",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Ben+Thanh+Market",
                        desc: "Street food dinner. Watch your bags. Good for souvenir shopping." 
                    }
                ]
            },
            {
                date: "Dec 22",
                day: "Mon",
                city: "HCMC",
                color: "purple",
                events: [
                    { 
                        time: "9:00 AM", 
                        title: "Independence Palace", 
                        address: "135 Nam Ky Khoi Nghia, District 1",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Independence+Palace+Ho+Chi+Minh",
                        desc: "Historical landmark. Easy walking distance to Post Office." 
                    },
                    { 
                        time: "12:00 PM", 
                        title: "Lunch: Pho Hoa Pasteur", 
                        address: "260C Pasteur, District 3",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Pho+Hoa+Pasteur",
                        desc: "One of the best Pho spots in the city." 
                    },
                    { 
                        time: "2:00 PM", 
                        title: "Shopping: Saigon Centre", 
                        address: "65 Le Loi, Ben Nghe, District 1",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Saigon+Centre",
                        desc: "Takashimaya. High-end AC shopping. Break from the heat." 
                    },
                    { 
                        time: "6:00 PM", 
                        title: "Saigon River Dinner Cruise", 
                        address: "5 Nguyen Tat Thanh, District 4 (Check Ticket)",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Saigon+River+Cruise+Port",
                        desc: "Book via Klook/Trip.com. Nice views, includes dinner." 
                    }
                ]
            },
            {
                date: "Dec 23",
                day: "Tue",
                city: "Transit",
                color: "red",
                events: [
                    { time: "10:15 AM", title: "Leave Airbnb", desc: "Head to SGN Domestic Terminal 1." },
                    { time: "1:25 PM", title: "Depart HCMC (VN 132)", desc: "Vietnam Airlines flight to Da Nang (Terminal 1)." },
                    { time: "2:50 PM", title: "Land in Da Nang", desc: "Arrival at DAD Terminal 1. Grab to Son Tra Airbnb." },
                    { 
                        time: "7:30 PM", 
                        title: "Pizza 4P's Indochina", 
                        isBooked: true, 
                        address: "74 Bach Dang, Hai Chau, Da Nang",
                        mapLink: "https://www.google.com/maps?q=Pizza+4P%27s+Indochina+Da+Nang,+74+B·∫°ch+ƒê·∫±ng,+Street,+H·∫£i+Ch√¢u,+ƒê√†+N·∫µng+550000,+Vietnam&ftid=0x3142193cf50bef09:0x6f1b1de8e432c22e&entry=gps",
                        desc: "Riverside View. Estimate ~15 min Grab." 
                    }
                ]
            },
            {
                date: "Dec 24",
                day: "Wed",
                city: "Da Nang",
                color: "cyan",
                events: [
                    { 
                        time: "9:00 AM", 
                        title: "Pink Cathedral & Han Market", 
                        address: "156 Tran Phu, Hai Chau, Da Nang",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Da+Nang+Cathedral",
                        desc: "Visit the famous pink church then shop at Han Market nearby." 
                    },
                    { 
                        time: "12:00 PM", 
                        title: "Lunch: Banh Xeo Ba Duong", 
                        address: "K280/23 Hoang Dieu, Da Nang",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Banh+Xeo+Ba+Duong",
                        desc: "Local specialty savory pancakes. Fun experience." 
                    },
                    { 
                        time: "2:00 PM", 
                        title: "My Khe Beach", 
                        address: "Vo Nguyen Giap Street, Da Nang",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=My+Khe+Beach",
                        desc: "Relaxing afternoon by the sea. Soft sand, great for kids." 
                    },
                    { 
                        time: "7:00 PM", 
                        title: "Xmas Eve: Madame Lan", 
                        address: "4 Bach Dang, Hai Chau, Da Nang",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Madame+Lan+Restaurant",
                        desc: "Beautiful courtyard restaurant. Reserve ahead!" 
                    }
                ]
            },
            {
                date: "Dec 25",
                day: "Thu",
                city: "Hoi An",
                color: "cyan",
                events: [
                    { 
                        time: "10:00 AM", 
                        title: "Marble Mountains", 
                        address: "81 Huyen Tran Cong Chua, Da Nang",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Marble+Mountains+Da+Nang",
                        desc: "Caves and pagodas. Use the elevator." 
                    },
                    { 
                        time: "2:00 PM", 
                        title: "Hoi An Ancient Town", 
                        address: "Hoi An, Quang Nam",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Hoi+An+Ancient+Town",
                        desc: "30 min drive. Pedestrian only zone." 
                    },
                    { 
                        time: "5:00 PM", 
                        title: "Lantern Boat Ride", 
                        address: "Bach Dang Street, Hoi An",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Hoi+An+Lantern+Boat",
                        desc: "On Thu Bon river. Release a lantern for Xmas wishes." 
                    },
                    { 
                        time: "8:00 PM", 
                        title: "Hoi An Night Market", 
                        address: "Nguyen Hoang Street, Hoi An",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Hoi+An+Night+Market",
                        desc: "Shopping for souvenirs. Return to Da Nang." 
                    }
                ]
            },
            {
                date: "Dec 26",
                day: "Fri",
                city: "Da Nang",
                color: "cyan",
                events: [
                    { 
                        time: "10:00 AM", 
                        title: "Coffee Making Workshop", 
                        isBooked: true, 
                        address: "Check Booking Confirmation",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Coffee+Workshop+Da+Nang",
                        desc: "Learn to make Vietnamese coffee. ~15 min Grab to city center." 
                    },
                    { 
                        time: "12:30 PM", 
                        title: "Lunch: Mi Quang 1A", 
                        address: "1A Hai Phong, Hai Chau, Da Nang",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Mi+Quang+1A",
                        desc: "Famous local noodle dish." 
                    },
                    { 
                        time: "2:30 PM", 
                        title: "Son Tra Peninsula", 
                        address: "Linh Ung Pagoda, Son Tra",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Linh+Ung+Pagoda+Son+Tra",
                        desc: "Visit Lady Buddha. Monkeys often seen here!" 
                    },
                    { 
                        time: "6:00 PM", 
                        title: "Helio Night Market", 
                        address: "2/9 Street, Hai Chau, Da Nang",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Helio+Night+Market",
                        desc: "Modern, clean. Live music & carnival games." 
                    }
                ]
            },
            {
                date: "Dec 27",
                day: "Sat",
                city: "Da Nang",
                color: "cyan",
                events: [
                    { time: "8:30 AM", title: "Depart for Ba Na Hills", desc: "~45-60 min drive. Book round trip transport." },
                    { 
                        time: "9:30 AM", 
                        title: "Ba Na Hills", 
                        isBooked: true, 
                        address: "Hoa Ninh, Hoa Vang, Da Nang",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Sun+World+Ba+Na+Hills",
                        desc: "Cable car, Golden Bridge, French Village, Buffet Lunch, Coaster." 
                    },
                    { time: "5:00 PM", title: "Return to Da Nang", desc: "Rest at Airbnb." },
                    { 
                        time: "9:00 PM", 
                        title: "Dragon Bridge Fire Show", 
                        address: "Dragon Bridge, Da Nang",
                        mapLink: "https://www.google.com/maps/search/?api=1&query=Dragon+Bridge+Da+Nang",
                        desc: "(Optional) Only happens Sat/Sun at 9pm." 
                    }
                ]
            },
            {
                date: "Dec 28",
                day: "Sun",
                city: "Home",
                color: "gray",
                events: [
                    { time: "9:30 AM", title: "Checkout & Leave", desc: "Head to DAD International Terminal 2." },
                    { time: "11:50 AM", title: "Depart Da Nang (SQ 171)", desc: "Singapore Airlines flight to Singapore (Terminal 2)." },
                    { time: "3:50 PM", title: "Land in Singapore", desc: "Arrival at Changi Terminal 2." }
                ]
            }
        ];

        const recData = [
            { 
                title: "Banh Xeo Ba Duong", 
                type: "food", 
                city: "Da Nang", 
                tags: ["Local", "Cheap"], 
                rating: 4.1, 
                reviews: "8.5k",
                address: "K280/23 Hoang Dieu, Da Nang",
                mapLink: "https://www.google.com/maps/search/?api=1&query=Banh+Xeo+Ba+Duong",
                desc: "Famous savory pancakes down a small alley. Fun DIY rolling." 
            },
            { 
                title: "Cong Caphe (Han Market)", 
                type: "food", 
                city: "Da Nang", 
                tags: ["Coffee", "Vibe"], 
                rating: 4.5, 
                reviews: "5.1k",
                address: "98-96 Bach Dang, Hai Chau",
                mapLink: "https://www.google.com/maps/search/?api=1&query=Cong+Caphe+Bach+Dang+Da+Nang",
                desc: "Coconut Coffee is a must-try. Coconut milk slushy with espresso." 
            },
            { 
                title: "Lotte Mart", 
                type: "shopping", 
                city: "Da Nang", 
                tags: ["Supplies", "AC"], 
                rating: 4.4, 
                reviews: "12k",
                address: "6 Nai Nam, Hai Chau, Da Nang",
                mapLink: "https://www.google.com/maps/search/?api=1&query=Lotte+Mart+Da+Nang",
                desc: "Good for stocking up on snacks/water for the Airbnb. Has a bowling alley." 
            },
            { 
                title: "Quan An Ngon 138", 
                type: "food", 
                city: "HCMC", 
                tags: ["Family", "Variety"], 
                rating: 4.2, 
                reviews: "8.2k",
                address: "138 Nam Ky Khoi Nghia, District 1",
                mapLink: "https://www.google.com/maps/search/?api=1&query=Quan+An+Ngon+138",
                desc: "Huge menu, food court style but seated service. Great for picky eaters." 
            },
            { 
                title: "Ao Dai Rental (Aobaba)", 
                type: "activity", 
                city: "Hoi An", 
                tags: ["Photos"], 
                rating: 4.8, 
                reviews: "300+",
                address: "148 Tran Phu, Hoi An",
                mapLink: "https://www.google.com/maps/search/?api=1&query=Aobaba+Hoi+An+Tailor",
                desc: "Rent traditional dresses for the whole family for photos in Hoi An." 
            },
            { 
                title: "Secret Garden", 
                type: "food", 
                city: "HCMC", 
                tags: ["Vibe", "Rooftop"], 
                rating: 4.4, 
                reviews: "3.2k",
                address: "158 Pasteur, District 1",
                mapLink: "https://www.google.com/maps/search/?api=1&query=Secret+Garden+Restaurant+HCMC",
                desc: "Authentic home-cooked meal atmosphere." 
            },
            { 
                title: "Grab App", 
                type: "activity", 
                city: "App", 
                tags: ["Transport"], 
                rating: 4.8, 
                reviews: "App Store",
                address: "Download on Phone",
                mapLink: "",
                desc: "Do not use street taxis. Link your credit card to Grab for easy 7-seater bookings." 
            },
        ];

        // --- FILTER STATE ---
        let activeCity = 'all';
        let activeType = 'all';

        // --- RENDER FUNCTIONS ---

        function renderTabs(activeIndex = 0) {
            const container = document.getElementById('dayTabs');
            container.innerHTML = itineraryData.map((day, index) => `
                <button onclick="switchDay(${index})" 
                    class="flex-shrink-0 px-4 py-3 rounded-xl border transition-all duration-200 ${index === activeIndex 
                        ? `bg-${day.color}-500 text-white border-${day.color}-600 shadow-md transform scale-105` 
                        : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'}"
                >
                    <div class="text-xs opacity-80 uppercase font-semibold">${day.date}</div>
                    <div class="font-bold text-lg leading-none mt-1">${day.day}</div>
                </button>
            `).join('');
        }

        function renderTimeline(index) {
            const data = itineraryData[index];
            const container = document.getElementById('timelineContent');
            
            let html = `
                <div class="flex items-center justify-between mb-6 pb-4 border-b border-gray-100">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">${data.date} - ${data.day}</h2>
                        <p class="text-${data.color}-600 font-medium">${data.city}</p>
                    </div>
                    <div class="text-3xl text-${data.color}-200">
                        <i class="fas ${index < 4 ? 'fa-city' : 'fa-water'}"></i>
                    </div>
                </div>
                <div class="space-y-6 relative border-l-2 border-${data.color}-100 ml-3 pl-6">
            `;

            html += data.events.map(event => {
                const mapButton = event.mapLink ? 
                    `<a href="${event.mapLink}" target="_blank" class="btn-map inline-flex items-center text-xs bg-white border border-gray-200 text-gray-600 px-2 py-1 rounded-md hover:bg-gray-50 hover:text-${data.color}-600 hover:border-${data.color}-300 mt-2 shadow-sm">
                        <i class="fas fa-location-dot mr-1.5 text-${data.color}-500"></i> View Map
                     </a>` : '';

                const addressText = event.address ? 
                    `<div class="text-xs text-gray-400 mt-1 flex items-start">
                        <i class="fas fa-map-pin mr-1.5 mt-0.5 flex-shrink-0"></i>
                        <span>${event.address}</span>
                     </div>` : '';

                if (event.isBooked) {
                    // BOOKED ITEM - Green Card
                    const bookedMapBtn = event.mapLink ? 
                        `<a href="${event.mapLink}" target="_blank" class="btn-map inline-flex items-center text-xs bg-white border border-green-300 text-green-700 px-2 py-1 rounded-md hover:bg-green-50 mt-2 shadow-sm">
                            <i class="fas fa-location-dot mr-1.5 text-green-600"></i> View Map
                         </a>` : '';
                    
                    const bookedAddress = event.address ? 
                        `<div class="text-xs text-green-700/70 mt-1 flex items-start">
                            <i class="fas fa-map-pin mr-1.5 mt-0.5 flex-shrink-0"></i>
                            <span>${event.address}</span>
                         </div>` : '';

                    return `
                        <div class="relative group">
                            <!-- Larger Timeline Dot -->
                            <div class="absolute -left-[38px] bg-green-500 h-5 w-5 rounded-full border-4 border-white shadow-sm mt-4 z-10"></div>
                            
                            <!-- Full Green Card -->
                            <div class="bg-green-50 border border-green-200 rounded-xl p-4 shadow-sm relative">
                                <div class="absolute top-0 right-0 bg-green-200 text-green-800 text-[10px] font-bold px-2 py-1 rounded-bl-lg rounded-tr-lg uppercase tracking-wider">
                                    Booked
                                </div>
                                <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-1 mb-1">
                                    <span class="font-bold text-green-700 text-sm w-24 flex-shrink-0">${event.time}</span>
                                    <div class="flex-grow">
                                        <h4 class="font-bold text-green-900 text-lg leading-tight">${event.title}</h4>
                                    </div>
                                </div>
                                <p class="text-green-800 text-sm">${event.desc}</p>
                                ${bookedAddress}
                                ${bookedMapBtn}
                            </div>
                        </div>
                    `;
                } else {
                    // STANDARD ITEM
                    return `
                        <div class="relative group">
                            <div class="absolute -left-[31px] bg-${data.color}-500 h-4 w-4 rounded-full border-4 border-white shadow-sm mt-1.5"></div>
                            <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-1">
                                <span class="font-bold text-${data.color}-600 text-sm w-20 flex-shrink-0">${event.time}</span>
                                <h4 class="font-bold text-gray-800 text-lg leading-tight">${event.title}</h4>
                            </div>
                            <p class="text-gray-600 text-sm mt-1 bg-gray-50 p-3 rounded-lg border border-gray-100">${event.desc}</p>
                            ${addressText}
                            ${mapButton}
                        </div>
                    `;
                }
            }).join('');

            html += `</div>`;
            container.innerHTML = html;
        }

        function switchDay(index) {
            renderTabs(index);
            renderTimeline(index);
        }

        function getCityColor(city) {
            if (city === 'HCMC') return 'bg-purple-100 text-purple-800';
            if (city === 'Da Nang' || city === 'Hoi An') return 'bg-cyan-100 text-cyan-800';
            return 'bg-gray-100 text-gray-600';
        }

        function getBorderColor(type) {
            if (type === 'food') return 'border-orange-200 hover:shadow-orange-100';
            if (type === 'activity') return 'border-blue-200 hover:shadow-blue-100';
            if (type === 'shopping') return 'border-pink-200 hover:shadow-pink-100';
            return 'border-gray-100';
        }

        function setCityFilter(city) {
            activeCity = city;
            updateFilterUI();
            renderRecommendations();
        }

        function setTypeFilter(type) {
            activeType = type;
            updateFilterUI();
            renderRecommendations();
        }

        function updateFilterUI() {
            // Update City Buttons
            document.querySelectorAll('.city-filter').forEach(btn => {
                const val = btn.dataset.val;
                if(val === activeCity) {
                    btn.classList.remove('bg-white', 'text-gray-600', 'border-gray-200');
                    if(val === 'hcmc') btn.classList.add('bg-purple-100', 'text-purple-800', 'border-purple-200');
                    else if(val === 'danang') btn.classList.add('bg-cyan-100', 'text-cyan-800', 'border-cyan-200');
                    else btn.classList.add('bg-gray-800', 'text-white', 'border-gray-800');
                } else {
                     btn.classList.add('bg-white', 'text-gray-600', 'border-gray-200');
                     if(val === 'hcmc') btn.classList.remove('bg-purple-100', 'text-purple-800', 'border-purple-200');
                     else if(val === 'danang') btn.classList.remove('bg-cyan-100', 'text-cyan-800', 'border-cyan-200');
                     else btn.classList.remove('bg-gray-800', 'text-white', 'border-gray-800');
                }
            });

             // Update Type Buttons
            document.querySelectorAll('.type-filter').forEach(btn => {
                const val = btn.dataset.val;
                if(val === activeType) {
                    btn.classList.remove('bg-white', 'text-gray-600', 'border-gray-200');
                    btn.classList.add('bg-gray-800', 'text-white', 'border-gray-800');
                } else {
                    btn.classList.add('bg-white', 'text-gray-600', 'border-gray-200');
                    btn.classList.remove('bg-gray-800', 'text-white', 'border-gray-800');
                }
            });
        }

        function renderRecommendations() {
            const container = document.getElementById('recommendationsGrid');
            
            const filtered = recData.filter(item => {
                // City Filter Logic
                let cityMatch = false;
                if (activeCity === 'all') {
                    cityMatch = true;
                } else if (activeCity === 'hcmc') {
                    cityMatch = (item.city === 'HCMC' || item.city === 'App');
                } else if (activeCity === 'danang') {
                    cityMatch = (item.city === 'Da Nang' || item.city === 'Hoi An' || item.city === 'App');
                }
                
                // Type Filter Logic
                let typeMatch = false;
                if (activeType === 'all') {
                    typeMatch = true;
                } else {
                    typeMatch = (item.type === activeType);
                }

                return cityMatch && typeMatch;
            });
            
            if (filtered.length === 0) {
                container.innerHTML = `<div class="col-span-full text-center py-10 text-gray-400 italic">No items match these filters.</div>`;
                return;
            }

            container.innerHTML = filtered.map(item => {
                const borderClass = getBorderColor(item.type);
                const cityClass = getCityColor(item.city);
                
                return `
                <div class="bg-white p-4 rounded-xl shadow-sm border-2 ${borderClass} hover:shadow-md transition-shadow flex flex-col h-full">
                    <div class="flex justify-between items-start">
                        <span class="text-xs font-bold uppercase tracking-wider text-gray-400">${item.type}</span>
                        <span class="${cityClass} text-[10px] px-2 py-0.5 rounded-full font-semibold">${item.city}</span>
                    </div>
                    
                    <h4 class="font-bold text-gray-800 mt-2 text-lg leading-tight">${item.title}</h4>
                    
                    ${item.rating ? `
                    <div class="flex items-center space-x-1 mt-1 mb-2">
                        <i class="fas fa-star text-yellow-400 text-xs"></i>
                        <span class="text-xs font-bold text-gray-700">${item.rating}</span>
                        <span class="text-xs text-gray-400">(${item.reviews})</span>
                    </div>
                    ` : ''}

                    <p class="text-gray-600 text-sm mt-1 mb-3 flex-grow">${item.desc}</p>
                    
                    ${item.address ? `
                    <div class="text-xs text-gray-400 mb-3 pt-2 border-t border-gray-50">
                        <i class="fas fa-map-marker-alt mr-1"></i> ${item.address}
                    </div>
                    ` : ''}

                    <div class="flex justify-between items-end mt-auto">
                        <div class="flex flex-wrap gap-1">
                            ${item.tags.map(tag => `<span class="text-xs bg-cyan-50 text-cyan-700 px-2 py-1 rounded border border-cyan-100">#${tag}</span>`).join('')}
                        </div>
                        ${item.mapLink ? `
                        <a href="${item.mapLink}" target="_blank" class="btn-map inline-flex items-center text-xs bg-white border border-gray-200 text-gray-600 px-2 py-1 rounded-md hover:bg-gray-50 hover:text-cyan-600 hover:border-cyan-300 shadow-sm transition">
                            <i class="fas fa-location-dot mr-1.5 text-cyan-500"></i> View Map
                        </a>` : ''}
                    </div>
                </div>
            `}).join('');
        }

        function copyText(text) {
            // Fallback for iframe/permissions policy restrictions
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px";
            textArea.style.top = "0";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    const toast = document.getElementById('toast');
                    toast.classList.remove('opacity-0');
                    setTimeout(() => toast.classList.add('opacity-0'), 2000);
                }
            } catch (err) {
                console.error('Copy failed', err);
            }
            document.body.removeChild(textArea);
        }

        function updateUpNext() {
            const now = new Date();
            // FOR DEMO: If current year is NOT 2025, default to looking at Dec 20, 2025 2:00 PM for testing
            // Remove this in production if you want real-time only
            // const now = new Date("Dec 20, 2025 14:00:00"); 

            let upcomingEvents = [];

            itineraryData.forEach(day => {
                day.events.forEach(event => {
                    // Simple parse: "Dec 20" + " " + "2025" + " " + "1:50 PM"
                    const eventDateString = `${day.date}, 2025 ${event.time}`;
                    const eventDate = new Date(eventDateString);
                    
                    if (eventDate > now) {
                        upcomingEvents.push({
                            dateObj: eventDate,
                            dayTitle: day.date,
                            ...event
                        });
                    }
                });
            });

            // Sort by time
            upcomingEvents.sort((a, b) => a.dateObj - b.dateObj);

            const container = document.getElementById('upNextContent');
            
            if (upcomingEvents.length > 0) {
                const next = upcomingEvents[0];
                const diffMs = next.dateObj - now;
                const diffHrs = Math.floor((diffMs % 86400000) / 3600000);
                const diffMins = Math.round(((diffMs % 86400000) % 3600000) / 60000);
                
                // Format nicely
                let timeString = "";
                const days = Math.floor(diffMs / 86400000);
                if (days > 0) timeString += `${days}d `;
                if (diffHrs > 0) timeString += `${diffHrs}h `;
                timeString += `${diffMins}m`;

                container.innerHTML = `
                    <div class="mt-2">
                        <div class="flex justify-between items-end">
                            <h2 class="text-2xl font-bold text-white leading-tight">${next.title}</h2>
                            <span class="text-sm bg-gray-700 px-2 py-1 rounded text-gray-300 whitespace-nowrap ml-2">${next.dayTitle} @ ${next.time}</span>
                        </div>
                        <p class="text-gray-400 text-sm mt-1">${next.desc}</p>
                        <div class="mt-4 pt-3 border-t border-gray-700 flex items-center text-sm text-green-400 font-mono">
                            <i class="fas fa-stopwatch mr-2"></i> Starts in ${timeString}
                        </div>
                    </div>
                `;
            } else {
                // Trip Over or Not Started (if dates are past)
                // Assuming past means done
                container.innerHTML = `
                    <div class="mt-2">
                        <h2 class="text-xl font-bold text-white">Trip Completed!</h2>
                        <p class="text-gray-400 text-sm mt-1">Hope you had a wonderful time in Vietnam.</p>
                    </div>
                `;
            }
        }

        // --- INIT ---

        window.addEventListener('DOMContentLoaded', () => {
            renderTabs(0);
            renderTimeline(0);
            updateFilterUI();
            renderRecommendations();
            
            // Initial call and interval for live clock
            updateUpNext();
            setInterval(updateUpNext, 60000); // Update every minute
        });

    </script>
</body>
</html>
